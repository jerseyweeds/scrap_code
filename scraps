aggregated_series = filtered_df.groupby('date').apply(lambda x: sum(x['market cap']) / sum(x['sales']))
